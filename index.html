<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>بوابة الإبداع</title>
  <style>
    body { font-family: Tahoma, sans-serif; }
    .news-slider {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding: 15px;
      background: #eee;
      border-radius: 8px;
      margin-top: 15px;
    }
    .news-card {
      min-width: 250px;
      background: white;
      border-radius: 8px;
      box-shadow: 0px 2px 6px rgba(0,0,0,0.1);
      padding: 10px;
      text-align: right;
    }
    .news-card img {
      width: 100%;
      border-radius: 6px;
    }
    .news-card h3 { margin: 10px 0 5px; }
    .news-card p { font-size: 14px; color: #555; }

    #editNewsBtn {
      background: #c09bd2;
      color: white;
      padding: 8px 15px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
      margin-bottom: 10px;
    }
    #editNewsBtn:hover { background: #9b75ad; }

    #editForm {
      display: none;
      margin-top: 20px;
      text-align: center;
      background: rgba(255, 255, 255, 0.9);
      padding: 15px;
      border-radius: 8px;
    }
    #editForm input, 
    #editForm textarea {
      width: 80%;
      max-width: 400px;
      padding: 8px;
      margin: 5px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    #editForm button {
      background: #22c55e;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
    }
    #editForm button:hover { background: #16a34a; }
  </style>
</head>
<body>

  <header>
    <h1>بوابة الإبداع</h1>
    <p>منصة المدرسة لعرض المواهب والإنجازات</p>
  </header>

  <h2 style="display:flex; justify-content:space-between; align-items:center;">
    📰 الأخبار
    <button id="editNewsBtn">✏️ تعديل الأخبار</button>
  </h2>

  <div class="news-slider" id="newsContainer"></div>

  <div id="editForm">
    <h3>إضافة خبر جديد</h3>
    <input type="text" id="newsTitle" placeholder="عنوان الخبر"><br>
    <textarea id="newsContent" placeholder="محتوى الخبر"></textarea><br>
    <input type="file" id="newsImage" accept="image/*"><br>
    <button type="button" id="addNewsBtn">📤 رفع وإضافة الخبر</button>
  </div>

  <footer>
    <p>© 2025 بوابة الإبداع - جميع الحقوق محفوظة</p>
  </footer>

  <!-- ✅ Script placed at the very bottom -->
  <script>
    const ADMIN_PASS = "Admin_2002";
    const NEWS_KEY = "bawabatalibda3_news";
    let newsEditMode = false;
    let newsData = JSON.parse(localStorage.getItem(NEWS_KEY) || "[]");

    function renderNews() {
      const container = document.getElementById("newsContainer");
      container.innerHTML = "";
      newsData.forEach((news, index) => {
        const card = document.createElement("div");
        card.className = "news-card";

        const img = document.createElement("img");
        img.src = news.image || "https://via.placeholder.com/600x300";
        card.appendChild(img);

        const h3 = document.createElement("h3");
        h3.textContent = news.title;
        card.appendChild(h3);

        const p = document.createElement("p");
        p.textContent = news.content;
        card.appendChild(p);

        if (newsEditMode) {
          const delBtn = document.createElement("button");
          delBtn.textContent = "🗑 حذف";
          delBtn.style.background = "#ef4444";
          delBtn.style.color = "#fff";
          delBtn.style.border = "none";
          delBtn.style.padding = "5px 10px";
          delBtn.style.borderRadius = "5px";
          delBtn.style.cursor = "pointer";
          delBtn.onclick = () => {
            newsData.splice(index, 1);
            localStorage.setItem(NEWS_KEY, JSON.stringify(newsData));
            renderNews();
          };
          card.appendChild(delBtn);
        }

        container.appendChild(card);
      });
    }

    function handleEditNews() {
      const pass = prompt("أدخل كلمة المرور للتعديل:");
      if (pass !== ADMIN_PASS) return alert("كلمة المرور غير صحيحة ❌");

      newsEditMode = !newsEditMode;
      const editForm = document.getElementById("editForm");
      const editBtn = document.getElementById("editNewsBtn");

      if (newsEditMode) {
        editForm.style.display = "block";
        editBtn.textContent = "🔒 الخروج من التعديل";
      } else {
        editForm.style.display = "none";
        editBtn.textContent = "✏️ تعديل الأخبار";
      }
      renderNews();
    }

    function addNews() {
      const title = document.getElementById("newsTitle").value.trim();
      const content = document.getElementById("newsContent").value.trim();
      const imageInput = document.getElementById("newsImage");

      if (!title || !content) {
        alert("الرجاء إدخال عنوان الخبر ومحتواه");
        return;
      }

      if (imageInput.files && imageInput.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
          saveNews(title, content, e.target.result);
        };
        reader.readAsDataURL(imageInput.files[0]);
      } else {
        saveNews(title, content, "");
      }
    }

    function saveNews(title, content, image) {
      newsData.push({ title, content, image });
      localStorage.setItem(NEWS_KEY, JSON.stringify(newsData));
      renderNews();

      // تنظيف الحقول
      document.getElementById("newsTitle").value = "";
      document.getElementById("newsContent").value = "";
      document.getElementById("newsImage").value = "";
      alert("✅ تم رفع الخبر بنجاح!");
    }

    // ✅ Attach listeners now that DOM exists
    renderNews();
    document.getElementById("editNewsBtn").onclick = handleEditNews;
    document.getElementById("addNewsBtn").onclick = addNews;
  </script>
</body>
</html>
